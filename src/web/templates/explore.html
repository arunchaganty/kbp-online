{% extends "base.html" %}

{% load static %}
{% load bootstrap3 %}

{% block header %}
<link rel="stylesheet" href="{% static 'kbpo/css/kbpo.css' %}">
{% endblock %}


{% block content %}
<div class="col-md-2"></div>
<div id="content-main" class="col-md-8">
  <div class="row">
  <h2>Explore the KBPOnline corpora and annotations</h2>
  <p>Select a corpus and document to examine from the choices below:</p>
  <!-- TODO: Have a drop box to select things here -->
  {{doc_id}}
  </div>

  <div class="row">
    <!-- TODO: Have a document frame that contains the document title and id -->
    <input id="doc-id" type="hidden" value={{doc_id}} />
    <div id="document" class="document">
    </div>
  </div>

  <script src="/static/requirejs/require.js"></script>
  <script>
    require.config({
      baseUrl: "/static/",
      paths: {
          "jquery": "jquery/dist/jquery",
          "bootstrap": "bootstrap/dist/js/bootstrap"
      },
    });
    require( ["jquery", "bootstrap", "kbpo/js/widgets/DocWidget"],
        function($, bootstrap, DocWidget) {
          // TODO: Based on the page, define the appropriate widgets.
          var docWidget = new DocWidget($("#document"));
          // Right now, docId is specified on the page.
          var docId = $("#doc-id").val();
          $.getJSON("/api/document/" + docId, function(doc) {
            console.info("loaded document ", doc.id);
            docWidget.loadDocument(doc);

            $.getJSON("/api/suggested-mentions/" + docId, function(mentions) {
              console.log(mentions)
              console.info("loaded ", mentions.length, " mentions.");
              docWidget.setSuggestions(mentions, "suggestion");
            });
          });
        }
    );
  </script>

</div>
<div class="col-md-2"></div>

{% endblock %}
